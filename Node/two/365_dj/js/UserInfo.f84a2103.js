(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["UserInfo"],{"6ef2":function(t,e,i){"use strict";i.r(e);var a,n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"userInfo"},[a("nav-head",{attrs:{title:"个人信息"}}),a("div",{staticClass:"item-wrap"},[a("label",{staticClass:"item",attrs:{for:"file"},on:{click:t.fileInit}},[a("span",{staticClass:"icon-head icon"}),a("span",[t._v("头像")]),t.UserInfo.avatar?a("div",{staticClass:"portrait",style:{backgroundImage:"url("+t.UserInfo.avatar+")"}}):a("div",{staticClass:"portrait"}),a("span",{staticClass:"arrow-right"})]),a("router-link",{staticClass:"item",attrs:{to:{path:"/nickName",query:{name:t.UserInfo.user_nickname}},tag:"div"}},[a("span",{staticClass:"icon-name icon"}),a("span",[t._v("昵称")]),t.UserInfo.user_nickname?a("span",{staticClass:"text"},[t._v(t._s(t.UserInfo.user_nickname))]):a("span",{staticClass:"text"},[t._v(t._s(t._f("phoneNumFormat")(t.UserInfo.mobile)))]),a("span",{staticClass:"arrow-right"})])],1),a("input",{ref:"file",staticStyle:{visibility:"hidden"},attrs:{id:"file",type:"file",name:"file",accept:"image/*",capture:"camera"},on:{change:t.FileChange}}),a("mt-popup",{staticStyle:{width:"100%","max-width":"640px","max-height":"100%"},attrs:{"popup-transition":"popup-fade"},model:{value:t.popupVisible,callback:function(e){t.popupVisible=e},expression:"popupVisible"}},[a("div",{staticStyle:{display:"block",height:"100vw"}},[a("img",{attrs:{id:"image",src:i("7dec")}})]),a("p",{staticStyle:{color:"red","text-align":"left","text-indent":"10px"}},[t._v("注:图片上传大小必须小于1MB")]),a("div",{staticClass:"button-rotatable"},[a("button",{on:{click:function(e){t.cropper&&t.cropper.rotate(-45)}}},[t._v("旋转-45°")]),a("button",{on:{click:function(e){t.cropper&&t.cropper.rotate(45)}}},[t._v("旋转+45°")]),a("button",{on:{click:t.Cropped}},[t._v("剪裁上传")])])])],1)},o=[],s=i("a322"),r=(i("3892"),i("450f")),c=i.n(r),p=(i("f2d0"),i("518b")),l=i.n(p),u=(i("5fc6"),i("5af2")),d=i.n(u),f=i("c93e"),m=i("c793"),b=i("2f62"),h=i("7ff4"),v=i("d5db"),g=i("8e8c");if(!document.querySelector("script#canvasToBlob")&&!HTMLCanvasElement.prototype.toBlob){var w=document.createElement("script");w.id="canvasToBlob",w.src="https://cdnjs.cloudflare.com/ajax/libs/javascript-canvas-to-blob/3.14.0/js/canvas-to-blob.min.js",document.body.appendChild(w)}var C={name:"userInfo",data:function(){return{popupVisible:!1,cropper:null}},methods:Object(f["a"])({},Object(b["c"])({setAvatarImg:h["E"]}),{fileInit:function(){this.$refs.file.removeAttribute("capture")},FileChange:function(t){var e=this;if(/.*(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(t.target.value)){var a=window.URL||window.webkitURL,n=a.createObjectURL(t.target.files[0]);if(n===document.getElementById("image").getAttribute("src"))return;if(null===this.cropper){var o=document.getElementById("image");o.setAttribute("src",n),g["a"].show(),Promise.all([i.e("1157").then(i.t.bind(null,"1157",7)),i.e("chunk-08e2").then(i.t.bind(null,"4604",7)),i.e("b5fc").then(i.bind(null,"b5fc"))]).then(function(t){g["a"].hide(),e.init(o,t[2].default),e.popupVisible=!0})}else this.cropper.replace(n),this.popupVisible=!0}else d()("错误文件格式,请重新选择")},init:function(t,e){this.cropper=new e(t,{minContainerWidth:window.innerWidth||250,minContainerHeight:window.innerWidth||250,minCanvasHeight:window.innerWidth||250,initialAspectRatio:1,dragMode:"move",aspectRatio:1})},Cropped:function(){var t=this;this.cropper&&this.cropper.getCroppedCanvas({maxWidth:window.innerWidth||250,maxHeight:window.innerWidth||250,fillColor:"#fff",imageSmoothingEnabled:!1,imageSmoothingQuality:"medium"}).toBlob(function(e){if(t.popupVisible=!1,e.size>1048576)d()("图片超出上传大小,请重选");else{var i=new FormData;i.append("file",e,"".concat(t.UserInfo.mobile,"_").concat((new Date).getTime(),"_").concat(parseInt(1e4*Math.random()),".jpg")),v["a"].postUserUpload(i).then(function(e){e.url&&v["a"].postEditNickname({avatar:e.url}).then(function(i){e.url!==i.avatar?t.setAvatarImg(e.url):d()("修改失败")})})}},"image/jpeg")}}),beforeDestroy:function(){this.cropper&&this.cropper.destroy()},components:(a={NavHead:m["a"]},Object(s["a"])(a,l.a.name,l.a),Object(s["a"])(a,c.a.name,c.a),a),computed:Object(f["a"])({},Object(b["d"])({UserInfo:function(t){return t.mine.User}}))},I=C,_=(i("b07d"),i("2877")),j=Object(_["a"])(I,n,o,!1,null,"e16e3580",null);j.options.__file="UserInfo.vue";e["default"]=j.exports},b07d:function(t,e,i){"use strict";var a=i("c3c7"),n=i.n(a);n.a},c3c7:function(t,e,i){}}]);
//# sourceMappingURL=UserInfo.f84a2103.js.map